import{a as Q}from"./with-props-18HQcUlf.js";import{l as e,v as X,r as d,o as q}from"./chunk-GNGMS2XR-Mr3CDDLu.js";import"./MapboxRoute-RjSmR17c.js";import{g as S}from"./utils-D27r_kA2.js";const V=({date:y={day:"",month:"",year:""},from:b="",to:l="",totalMilesDrivingToday:g="",totalMileageToday:h="",carrierName:w="",mainOfficeAddress:E="",homeTerminalAddress:u="",truckNumberInfo:D="",logData:m={offDuty:[],sleeper:[],driving:[],onDuty:[]},remarks:G="",shippingDocuments:k="",manifestNumber:_=""})=>{const T=a=>a===0?"Minight":a===12?"Noon":a<12?`${a}`:`${a-12}`,$=a=>a===1?m.offDuty.length:a===2?m.sleeper.length:a===3?m.driving.length:a===4?m.onDuty.length:0,v=()=>e.jsxs("div",{className:"flex h-6 border-t border-black bg-gray-800 text-white",style:{height:"50px"},children:[e.jsx("div",{className:"text-xs flex items-center pl-1",style:{width:"150px"}}),e.jsx("div",{className:"flex flex-1 relative",children:Array.from({length:24},(a,r)=>e.jsx("div",{className:"text-xs flex items-center justify-center",style:{width:"4.16%",height:"100%"},children:e.jsx("span",{className:"font-bold text-xs",style:{position:"relative",left:"-18px",top:"5px"},children:T(r)})}))}),e.jsx("div",{className:"w-12 pl-1 border-l border-black font-bold text-xs flex items-center justify-center",style:{position:"relative",left:"-3px"},children:e.jsx("span",{children:"Total Hours"})})]}),o=(a,r)=>e.jsxs("div",{className:"flex h-6 border-t border-black",children:[e.jsxs("div",{className:"border-r border-black text-xs flex items-center pl-1",style:{width:"150px"},children:[r,". ",a]}),e.jsx("div",{className:"flex flex-1 relative",children:Array.from({length:24},(L,f)=>e.jsxs("div",{className:"border-r border-black",style:{width:"4.16%",height:"100%"},children:[r===1&&m.offDuty.includes(f)&&e.jsx("div",{className:"h-1/3 bg-blue-400 mt-2"}),r===2&&m.sleeper.includes(f)&&e.jsx("div",{className:"h-1/3 bg-blue-400 mt-2"}),r===3&&m.driving.includes(f)&&e.jsx("div",{className:"h-1/3 bg-blue-400 mt-2"}),r===4&&m.onDuty.includes(f)&&e.jsx("div",{className:"h-1/3 bg-blue-400 mt-2"})]},`cell-${a}-${f}`))}),e.jsx("div",{className:"w-12 text-sm font-bold flex items-center justify-center",children:$(r)})]},`grid-${a}`);return e.jsx("div",{className:"bg-white p-4 max-w-6xl mx-auto",children:e.jsxs("div",{className:"border border-black p-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("div",{className:"text-md font-bold",children:"Driver's Daily Log"}),e.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[e.jsx("div",{className:"border-b border-black px-4 text-center",children:y.day}),e.jsx("div",{children:"/"}),e.jsx("div",{className:"border-b border-black px-4 text-center",children:y.month}),e.jsx("div",{children:"/"}),e.jsx("div",{className:"border-b border-black px-4 text-center",children:y.year})]})]}),e.jsxs("div",{className:"flex mb-2",children:[e.jsxs("div",{className:"w-1/2 flex p-4",children:[e.jsx("div",{className:"w-14 font-bold text-sm text-gray-600",children:"From:"}),e.jsx("div",{className:"flex-1 border-b border-black text-sm",children:b})]}),e.jsxs("div",{className:"w-1/2 flex p-4",children:[e.jsx("div",{className:"w-10 font-bold text-sm text-gray-600",children:"To:"}),e.jsx("div",{className:"flex-1 border-b border-black text-sm",children:l})]})]}),e.jsxs("div",{className:"flex mb-2",children:[e.jsx("div",{className:"w-1/2 border border-black p-1 mr-1 text-sm",children:e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"w-1/2 border-r border-black p-1 text-center",children:[e.jsx("div",{className:"border-b border-black pb-1 text-center text-gray-600 text-xs",children:"Total Miles Driving Today"}),e.jsx("div",{className:"text-center pt-1 font-medium",children:g})]}),e.jsxs("div",{className:"w-1/2 p-1 text-center",children:[e.jsx("div",{className:"border-b border-black pb-1 text-center text-gray-600 text-xs",children:"Total Mileage Today"}),e.jsx("div",{className:"text-center pt-1 font-medium",children:h})]})]})}),e.jsxs("div",{className:"w-1/2 border border-black p-1 text-sm",children:[e.jsx("div",{className:"border-b border-black pb-1 text-center text-gray-600 text-xs",children:"Name of Carrier or Carriers"}),e.jsx("div",{className:"text-center pt-1 font-medium",children:w})]})]}),e.jsxs("div",{className:"flex mb-2",children:[e.jsxs("div",{className:"w-1/2 border border-black p-1 mr-1",children:[e.jsx("div",{className:"border-b border-black pb-1 text-center text-xs text-gray-600",children:"Truck/Trailer and Entity Numbers or License Numbers (Show each unit)"}),e.jsx("div",{className:"text-center pt-1 font-medium text-sm",children:D})]}),e.jsxs("div",{className:"w-1/2 border border-black p-1 text-sm",children:[e.jsx("div",{className:"border-b border-black pb-1 text-center text-gray-600 text-xs",children:"Home Terminal Address"}),e.jsx("div",{className:"text-center pt-1 font-medium",children:u})]})]}),e.jsxs("div",{className:"mt-4",children:[v(),o("Off Duty",1),o("Sleeper Berth",2),o("Driving",3),o("On Duty (Not Driving)",4)]}),e.jsxs("div",{className:"mt-4 border border-black p-1",children:[e.jsx("div",{className:"border-b border-black pb-1 font-bold text-sm",children:"Remarks"}),e.jsx("div",{className:"h-10 text-xs",children:e.jsx("ul",{style:{listStyleType:"circle",paddingLeft:"20px"}})})]}),e.jsxs("div",{className:"mt-2 border border-black p-1",children:[e.jsx("div",{className:"font-bold mb-1 text-sm",children:"Shipping Documents:"}),e.jsx("div",{className:"mb-2 text-xs",children:k}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"w-1/3 pr-1",children:[e.jsx("div",{className:"font-bold text-sm",children:"Pro or Manifest No."}),e.jsx("div",{className:"border-b border-black pb-1",children:_})]})}),e.jsxs("div",{className:"mt-4 text-xs",children:["Enter name of place you reported and where unloaded from ways and when and where each change of duty occurred.",e.jsx("br",{}),"Use time standard of time at home terminal."]})]}),e.jsxs("div",{className:"mt-4 border border-black text-xs",children:[e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"w-1/4 p-1 border-r border-black",children:[e.jsx("div",{className:"font-bold",children:"Recap:"}),e.jsx("div",{children:"Calculate as of end of day"})]}),e.jsx("div",{className:"w-1/4 p-1 border-r border-black",children:e.jsx("div",{className:"font-bold",children:"70 Hour / 8 Day"})}),e.jsx("div",{className:"w-1/4 p-1 border-r border-black",children:e.jsx("div",{className:"font-bold",children:"60 Hour / 7 Day"})}),e.jsx("div",{className:"w-1/4 p-1",children:e.jsx("div",{className:"font-bold",children:"*If you took 34 consecutive hours off duty, you may reset hours to 0"})})]}),e.jsxs("div",{className:"flex border-t border-black",children:[e.jsx("div",{className:"w-1/4 p-1 border-r border-black",children:e.jsx("div",{className:"font-bold",children:"On Duty Hours Today: 3 & 4"})}),e.jsxs("div",{className:"w-1/4 flex border-r border-black",children:[e.jsx("div",{className:"w-1/3 p-1 border-r border-black",children:e.jsx("div",{className:"font-bold",children:"A. Total hours on duty today:"})}),e.jsx("div",{className:"w-1/3 p-1 border-r border-black",children:e.jsx("div",{className:"font-bold",children:"B. Total hours on duty previous 7 days:"})}),e.jsx("div",{className:"w-1/3 p-1",children:e.jsx("div",{className:"font-bold",children:"C. Total hours on duty previous 8 days:"})})]}),e.jsxs("div",{className:"w-1/4 flex border-r border-black",children:[e.jsx("div",{className:"w-1/3 p-1 border-r border-black",children:e.jsx("div",{className:"font-bold",children:"A. Total hours on duty today:"})}),e.jsx("div",{className:"w-1/3 p-1 border-r border-black",children:e.jsx("div",{className:"font-bold",children:"B. Total hours on duty previous 6 days:"})}),e.jsx("div",{className:"w-1/3 p-1",children:e.jsx("div",{className:"font-bold",children:"C. Total hours on duty previous 7 days:"})})]}),e.jsx("div",{className:"w-1/4 p-1",children:e.jsx("div",{children:"Indicate how many hours 60/70 available:"})})]})]})]})})},W="pk.eyJ1IjoidGxvdGxpc28xOTkxIiwiYSI6ImNtOGhvNmczbzAzemIyanF5aGJ4MzcycTMifQ.srM8EiwddIzpHRGpvGTo5g",ae=Q(function(){const{id:b}=X(),[l,g]=d.useState(null),[h,w]=d.useState(null),[E,u]=d.useState(!0),[D,m]=d.useState(null),[G,k]=d.useState(null),[_,T]=d.useState(null),[$,v]=d.useState(!1),[o,a]=d.useState(null),[r,L]=d.useState(null),[f,C]=d.useState(null),[Z,z]=d.useState(null),[M,B]=d.useState(null),J=async t=>{try{const s=await fetch(S()+`/api/drivers/${t}`);if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);const n=await s.json();console.log("Driver data:",n),g(n)}catch(s){console.error("Error fetching driver:",s)}},U=async()=>{var t,s,n,x,p,j,c,A,O,I,P,F;u(!0);try{const N=await fetch(S()+`/api/trips/${b}`);if(!N.ok)throw new Error(`HTTP error! Status: ${N.status}`);const i=await N.json();console.log("Trip data:",i),Y([((t=i.current_coordinates)==null?void 0:t.lng)||0,((s=i.current_coordinates)==null?void 0:s.lat)||0],[((n=i.pickup_coordinates)==null?void 0:n.lng)||0,((x=i.pickup_coordinates)==null?void 0:x.lat)||0],[((p=i.dropoff_coordinates)==null?void 0:p.lng)||0,((j=i.dropoff_coordinates)==null?void 0:j.lat)||0]),w(i),m([((c=i.current_coordinates)==null?void 0:c.lng)||0,((A=i.current_coordinates)==null?void 0:A.lat)||0]),T([((O=i.pickup_coordinates)==null?void 0:O.lng)||0,((I=i.pickup_coordinates)==null?void 0:I.lat)||0]),k([((P=i.dropoff_coordinates)==null?void 0:P.lng)||0,((F=i.dropoff_coordinates)==null?void 0:F.lat)||0]),u(!1)}catch(N){console.error("Error fetching trip:",N),u(!1)}},R=async(t,s,n="route")=>{try{const x=`${t[0]},${t[1]}`,p=`${s[0]},${s[1]}`,j=await fetch(`https://api.mapbox.com/directions/v5/mapbox/driving/${x};${p}?geometries=geojson&access_token=${W}`);if(!j.ok)throw new Error("Failed to fetch route");const c=await j.json();if(console.log("Route data:",c.routes),console.log("Route distance:",c.routes[0].distance),console.log("Route duration:",c.routes[0].duration),c.routes&&c.routes.length>0)n==="route"?a({type:"Feature",properties:{distance:c.routes[0].distance,duration:c.routes[0].duration},geometry:c.routes[0].geometry}):n==="route2"&&L({type:"Feature",properties:{distance:c.routes[0].distance,duration:c.routes[0].duration},geometry:c.routes[0].geometry});else throw new Error("No route found")}catch(x){const p=x instanceof Error?x.message:"Unknown error";C(p),console.error("Error fetching route:",x)}finally{u(!1)}},Y=async(t,s,n)=>{if(!(!t||!s||!n)){v(!0);try{await R([t[0],t[1]],[s[0],s[1]],"route"),await R([s[0],s[1]],[n[0],n[1]],"route2"),v(!1)}catch(x){z(x.message),v(!1),console.error("Error fetching routes:",x)}}},K=async()=>{try{const t=await fetch(S()+`/api/v2/trips/${b}/time-log`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({driver:1,route1_duration:o==null?void 0:o.properties.duration,route1_distance:o==null?void 0:o.properties.distance,route2_duration:r==null?void 0:r.properties.duration,route2_distance:r==null?void 0:r.properties.distance})});if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const s=await t.json();console.log("Time log sheet data:",s),B(s)}catch(t){console.error("Error fetching time log sheet:",t)}},H=t=>t/1609.34;return d.useEffect(()=>{J("1"),U()},[b]),d.useEffect(()=>{o&&r&&(console.log("Lets get the time log sheet data!! Nikka!"),K())},[o,r]),e.jsx("div",{className:"min-h-screen bg-gray-100 p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto bg-white rounded-xs shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"Log Sheets"}),e.jsx(q,{to:`/trip/${b}`,className:"text-sm text-[#043f51] hover:text-[#008080] flex items-center",children:"‚Üê Back to Trip Information"})]}),E||!o||!r||!l||!h||!M?e.jsx("p",{children:"Loading..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("hr",{className:"mb-6 mt-0"}),e.jsx("div",{className:"",children:e.jsx("div",{className:"",children:e.jsx(V,{date:{day:new Date(h.created_at).getDate().toString(),month:(new Date(h.created_at).getMonth()+1).toString(),year:new Date().getFullYear().toString()},from:h.current_location,to:h.dropoff_location,carrierName:l==null?void 0:l.carrier,homeTerminalAddress:l==null?void 0:l.home_terminal_address,truckNumberInfo:(l==null?void 0:l.license_number)+" / "+(l==null?void 0:l.trailer_number),totalMilesDrivingToday:H(o.properties.distance+r.properties.distance).toFixed(0),totalMileageToday:H(r.properties.distance+o.properties.distance).toFixed(0),logData:M})})})]})]})})});export{ae as default};
